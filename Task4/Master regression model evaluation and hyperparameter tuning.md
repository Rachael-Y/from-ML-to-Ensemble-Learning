Task4 æŒæ¡å›å½’æ¨¡å‹çš„è¯„ä¼°åŠè¶…å‚æ•°è°ƒä¼˜

ç›®çš„ï¼šè™½ç„¶ç½‘æ ¼è°ƒå‚éšæœºæœç´¢æ–¹ä¾¿åˆå¿«é€Ÿï¼Œä½†æ˜¯äººäººéƒ½ä¼šç”¨ï¼Œç«èµ›ä¸­ä¸æ˜“æ‹‰å¼€å·®è·ã€‚è¦æƒ³çœŸæ­£è„±é¢–è€Œå‡ºï¼Œç†è§£æ¨¡å‹çš„åŸç†ã€æŒæ¡å‚æ•°å˜åŒ–çš„è¶‹åŠ¿å’Œä¼˜åŒ–æ–¹å‘æ‰æ˜¯ç¡¬æ ¸å®åŠ›ï¼
å‘Šåˆ«è°ƒå‚ä¾ ï¼ŒçœŸæ­£æ‹¥æœ‰å¯¹æ¨¡å‹çš„è°ƒè¯•èƒ½åŠ›ï¼


æœºå™¨å­¦ä¹ æ¨¡å‹è¯„ä¼°ä¸è¶…å‚æ•°è°ƒä¼˜è¯¦è§£https://zhuanlan.zhihu.com/p/140040705

æœºå™¨å­¦ä¹ ä¼˜åŒ–ç®—æ³•ä¹‹è´å¶æ–¯ä¼˜åŒ– https://zhuanlan.zhihu.com/p/146329121 

æœ€ä¼˜åŒ–ç†è®ºä¹‹æ— çº¦æŸä¼˜åŒ–åŸºæœ¬ç»“æ„åŠå…¶pythonåº”ç”¨ https://zhuanlan.zhihu.com/p/163405865

sklearn ä¸­æ–‡æ–‡æ¡£  https://sklearn.apachecn.org/docs/master/50.html


1.å›å½’æ¨¡å‹çš„è¯„ä¼°
   æ¨¡å‹çš„è¯„ä¼°åŒ…å«ä¸‰ä¸ªæŒ‡æ ‡ï¼šSSE(è¯¯å·®å¹³æ–¹å’Œ)ã€R-square(å†³å®šç³»æ•°)å’ŒAdjusted R-Square (æ ¡æ­£å†³å®šç³»æ•°ï¼‰

1.1 SSE â€“ è¯¯å·®å¹³æ–¹å’Œ
å…¬å¼å¦‚ä¸‹ï¼š

å¯¹åŒä¸€ä¸ªæ•°æ®é›†ï¼Œä¸åŒæ¨¡å‹ä¼šæœ‰ä¸åŒçš„SSEï¼ŒSSEè¶Šå°ï¼Œè¯´æ˜æ¨¡å‹çš„è¯¯å·®è¶Šå°ï¼Œå‡†ç¡®ç‡è¶Šé«˜ã€‚
å¯¹ä¸åŒçš„æ•°æ®é›†ï¼Œéšç€æ•°æ®é›†çš„å¢åŠ ï¼Œè¯¯å·®ä¹Ÿä¼šå¢å¤§ï¼Œå› æ­¤æ­¤æ—¶ç ”ç©¶SSEæ²¡æœ‰æ„ä¹‰ã€‚

1.2 R-square â€“ å†³å®šç³»æ•°
å†³å®šç³»æ•°æ˜¯é€šè¿‡æ•°æ®çš„å˜åŒ–æ¥è¡¨å¾ä¸€ä¸ªæ‹Ÿåˆçš„å¥½åã€‚
å…¬å¼å¦‚ä¸‹ï¼š


åˆ†æ¯æ˜¯åŸå§‹æ•°æ®çš„ç¦»æ•£ç¨‹åº¦ï¼Œåˆ†å­ä¸ºé¢„æµ‹æ•°æ®å’ŒåŸå§‹æ•°æ®çš„è¯¯å·®å¹³æ–¹å’Œï¼ŒäºŒè€…ç›¸é™¤å¯ä»¥æ¶ˆé™¤åŸå§‹æ•°æ®ç¦»æ•£ç¨‹åº¦çš„å½±å“ã€‚

ç†è®ºä¸ŠRçš„å–å€¼èŒƒå›´ï¼ˆ-âˆï¼Œ1]ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­çš„å–å€¼èŒƒå›´ä¸º[0 1] ------ å®é™…æ“ä½œä¸­é€šå¸¸ä¼šé€‰æ‹©æ‹Ÿåˆè¾ƒå¥½çš„æ›²çº¿è®¡ç®—RÂ²ï¼Œå› æ­¤å¾ˆå°‘å‡ºç°-âˆã€‚
Rè¶Šæ¥è¿‘1ï¼Œè¡¨æ˜æ–¹ç¨‹çš„å˜é‡å¯¹yçš„è§£é‡Šèƒ½åŠ›è¶Šå¼ºï¼Œè¿™ä¸ªæ¨¡å‹å¯¹æ•°æ®æ‹Ÿåˆçš„ä¹Ÿè¾ƒå¥½ã€‚
Rè¶Šæ¥è¿‘0ï¼Œè¡¨æ˜æ¨¡å‹æ‹Ÿåˆçš„è¶Šå·®ã€‚
ç»éªŒå€¼ï¼š>0.4ï¼Œ æ‹Ÿåˆæ•ˆæœå¥½ã€‚

1.3 Adjusted R-Square â€“ æ ¡æ­£å†³å®šç³»æ•°
å…¬å¼å¦‚ä¸‹ï¼š

å…¶ä¸­nä¸ºæ ·æœ¬æ•°é‡ï¼Œpä¸ºç‰¹å¾æ•°é‡ã€‚
ä¼˜ç‚¹ï¼šæ ¡æ­£å†³å®šç³»æ•°æ¶ˆé™¤äº†æ ·æœ¬æ•°é‡å’Œç‰¹å¾æ•°é‡çš„å½±å“ã€‚

2.è¶…å‚æ•°è°ƒä¼˜
   2.1 å‚æ•°è°ƒä¼˜
   æ¨¡å‹å‚æ•°æ˜¯æ¨¡å‹å†…éƒ¨çš„é…ç½®å˜é‡ï¼Œå…¶å€¼å¯ä»¥æ ¹æ®æ•°æ®è¿›è¡Œä¼°è®¡ã€‚ä¸€ä¸‹æ˜¯å‚æ•°çš„ä¸€äº›ç‰¹ç‚¹ï¼š
   å‚æ•°åœ¨é¢„æµ‹ä¸­ç”¨åˆ°ï¼Œæ˜¯ä»æ•°æ®ä¼°è®¡ä¸­è·å–çš„ã€‚
   å‚æ•°å®šä¹‰äº†å¯ä½¿ç”¨çš„æ¨¡å‹ï¼Œé€šå¸¸ä¸ç”±ç¼–ç¨‹è€…æ‰‹åŠ¨è®¾ç½®ã€‚
   å‚æ•°é€šå¸¸è¢«ä¿å­˜ä¸ºå­¦ä¹ æ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯æœºå™¨å­¦ä¹ ç®—æ³•çš„å…³é”®ï¼Œé€šå¸¸ç”±è¿‡å»çš„è®­ç»ƒæ•°æ®ä¸­æ€»ç»“å¾—å‡º ã€‚

2.2 è¶…å‚æ•°è°ƒä¼˜
æ¨¡å‹è¶…å‚æ•°æ˜¯æ¨¡å‹å¤–éƒ¨çš„é…ç½®ï¼Œå…¶å€¼æ— æ³•ä»æ•°æ®ä¸­ä¼°è®¡ã€‚
è¶…å‚æ•°é€šå¸¸ç”¨äºå¸®åŠ©ä¼°è®¡æ¨¡å‹å‚æ•°ï¼Œé€šå¸¸ç”±äººå·¥æŒ‡å®šã€‚
è¶…å‚æ•°é€šå¸¸å¯ä»¥ä½¿ç”¨å¯å‘å¼è®¾ç½®ã€‚
è¶…å‚æ•°ç»å¸¸è¢«è°ƒæ•´ä¸ºç»™å®šçš„é¢„æµ‹å»ºæ¨¡é—®é¢˜ï¼Œå–ä¸åŒçš„è¶…å‚æ•°çš„å€¼å¯¹äºæ¨¡å‹çš„æ€§èƒ½æœ‰ä¸åŒçš„å½±å“ã€‚

3.è¶…å‚æ•°çš„åº”ç”¨
   3.1 ç½‘æ ¼æœç´¢GridSearchCV()
   ç½‘æ ¼æœç´¢æ˜¯ä»è¶…å‚æ•°ç©ºé—´ä¸­å¯»æ‰¾æœ€ä¼˜çš„è¶…å‚æ•°ï¼Œå¾ˆåƒä¸€ä¸ªç½‘æ ¼ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜çš„èŠ‚ç‚¹ã€‚
   ä¸¾ä¾‹ï¼š ğœ†=0.01,0.1,1.0 å’Œ ğ›¼=0.01,0.1,1.0 , ç»„æˆä¸€ä»½æ’åˆ—ç»„åˆï¼Œå³ï¼š{[0.01,0.01],[0.01,0.1],[0.01,1],[0.1,0.01],[0.1,0.1],[0.1,1.0],[1,0.01],[1,0.1],[1,1]} ï¼Œç„¶åé’ˆå¯¹æ¯ç»„è¶…å‚æ•°åˆ†åˆ«å»ºç«‹ä¸€ä¸ªæ¨¡å‹ï¼Œç„¶åé€‰æ‹©æµ‹è¯•è¯¯å·®æœ€å°çš„é‚£ç»„è¶…å‚æ•°ã€‚

3.2 éšæœºæœç´¢ RandomizedSearchCV()
éšæœºæœç´¢ä¸­çš„æ¯ä¸ªå‚æ•°éƒ½æ˜¯ä»å¯èƒ½çš„å‚æ•°å€¼çš„åˆ†å¸ƒä¸­é‡‡æ ·çš„ã€‚
ä¸ç½‘æ ¼æœç´¢ç›¸æ¯”ï¼Œéšå³æœç´¢æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š
ï¼ˆaï¼‰. å¯ä»¥ç‹¬ç«‹äºå‚æ•°æ•°é‡å’Œå¯èƒ½çš„å€¼æ¥é€‰æ‹©è®¡ç®—æˆæœ¬ã€‚
ï¼ˆbï¼‰. æ·»åŠ ä¸å½±å“æ€§èƒ½çš„å‚æ•°ä¸ä¼šé™ä½æ•ˆç‡ã€‚

sklearnä¸­å¯¹åº”å‡½æ•°
random_search =
RandomizedSearchCV(clf,param_distributions=param_dist,n_iter=n_iter_search, cv=5, iid=False)
å…·ä½“å«ä¹‰å‚è€ƒï¼šRandomizedSearchCV

2.2.2 ä»£ç å®æˆ˜
#éšæœºæœç´¢
from scipy.stats import randint as sp_randint
from sklearn.model_selection import RandomizedSearchCV
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import cross_val_score #KæŠ˜äº¤å‰éªŒè¯

from sklearn.datasets import load_digits
digits = load_digits()
X, y = digits.data, digits.target

#åˆ†ç±»é—®é¢˜ï¼Œå…ˆå»ºç«‹ä¸€ä¸ªåˆ†ç±»å™¨
clf = RandomForestClassifier(n_estimators=20)

#ç»™å®šå‚æ•°æœç´¢èŒƒå›´
param_test={'max_depth':range(5,10,25),
           'max_features':sp_randint(1,11),
           "min_samples_split": sp_randint(2, 11)}

#RandomSearch+CVé€‰å–è¶…å‚æ•°
random_search = RandomizedSearchCV(clf,param_distributions =param_test,n_iter=20,cv=5)

random_search.fit(X,y)
print("éšæœºæœç´¢æœ€ä¼˜å¾—åˆ†ï¼š",random_search.best_score_)
print("éšæœºæœç´¢æœ€ä¼˜å‚æ•°ç»„åˆï¼š\n",random_search.best_params_)



éšæœºæœç´¢æœ€ä¼˜å¾—åˆ†ï¼š 0.8820458062519343
éšæœºæœç´¢æœ€ä¼˜å‚æ•°ç»„åˆï¼š
 {'max_depth': 5, 'max_features': 7, 'min_samples_split': 5}

æ ¹æ®ä»¥ä¸Šä¸åŒæ¨¡å‹çš„ä»£ç åŠè¿è¡Œç»“æœå¯ä»¥çœ‹å‡ºæ¥ï¼Œéšæœºæœç´¢çš„ä¼˜åŠ¿ä½“ç°åœ¨èƒ½å¯¹ä¸€ä¸ªç»™å®šèŒƒå›´å†…çš„å‚æ•°æ±‚æœ€ä¼˜ã€‚
